import{N as ue,g as pe,a as he,L as fe,d as K,p as P,i as A,b as s,s as a,t as N,e as be,c as H,f as k,h as O,j as y,k as v,l as p,m as x,n as M,o as L,u as F,q as _e,r as G,v as ge,w as ke,x as me,y as oe,z as ye,A as we,B as xe,C as ne,D as Se}from"./profiles-CYDD6ipJ.js";const qe=Symbol("is custom element"),je=Symbol("is html");function le(u,o,n,t){var e=Te(u);e[o]!==(e[o]=n)&&(o==="loading"&&(u[fe]=n),n==null?u.removeAttribute(o):typeof n!="string"&&ze(u).includes(o)?u[o]=n:u.setAttribute(o,n))}function Te(u){return u.__attributes??={[qe]:u.nodeName.includes("-"),[je]:u.namespaceURI===ue}}var ie=new Map;function ze(u){var o=u.getAttribute("is")||u.nodeName,n=ie.get(o);if(n)return n;ie.set(o,n=[]);for(var t,e=u,l=Element.prototype;l!==e;){t=he(e);for(var d in t)t[d].set&&n.push(d);e=pe(e)}return n}function Ee(u,o,n,t){var e=t,l=!0,d=()=>(l&&(l=!1,e=t),e),f;f=u[o],f===void 0&&t!==void 0&&(f=d());var j;return j=()=>{var S=u[o];return S===void 0?d():(l=!0,S)},j}var Ce=x('<p class="error svelte-15ijoy3"> </p>'),Me=x('<div class="login-container svelte-15ijoy3"><div class="login-header svelte-15ijoy3"><svg class="logo svelte-15ijoy3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <h1 class="svelte-15ijoy3">Noted.</h1> <p class="subtitle svelte-15ijoy3"> </p></div> <form autocomplete="on" class="svelte-15ijoy3"><div class="field svelte-15ijoy3"><input type="email" name="email" autocomplete="username" placeholder="Email" required="" class="svelte-15ijoy3"/></div> <div class="field svelte-15ijoy3"><input type="password" name="password" placeholder="Password" required="" minlength="6" class="svelte-15ijoy3"/></div> <!> <button type="submit" class="submit-btn svelte-15ijoy3"> </button></form> <button class="toggle-btn svelte-15ijoy3"> </button></div>');function Ie(u,o){P(o,!0);let n=y(""),t=y(""),e=y(!1),l=y(!1),d=y("");async function f(b){b.preventDefault(),a(l,!0),a(d,"");const{error:z}=s(e)?await L.auth.signUp({email:s(n),password:s(t),options:{emailRedirectTo:"https://imtjls3t.github.io/noted/"}}):await L.auth.signInWithPassword({email:s(n),password:s(t)});z?a(d,z.message,!0):s(e)&&a(d,"Check your email for a confirmation link."),a(l,!1)}var j=Me(),S=v(j),_=p(v(S),4),g=v(_),m=p(S,2),C=v(m),R=v(C),I=p(C,2),q=v(I),D=p(I,2);{var w=b=>{var z=Ce(),J=v(z);N(()=>M(J,s(d))),k(b,z)};A(D,b=>{s(d)&&b(w)})}var T=p(D,2),i=v(T),c=p(m,2);c.__click=()=>{a(e,!s(e)),a(d,"")};var h=v(c);N(()=>{M(g,s(e)?"Create an account":"Sign in to continue"),R.disabled=s(l),le(q,"autocomplete",s(e)?"new-password":"current-password"),q.disabled=s(l),T.disabled=s(l),M(i,s(l)?"...":s(e)?"Sign Up":"Sign In"),M(h,s(e)?"Already have an account? Sign in":"Don't have an account? Sign up")}),be("submit",m,f),H(R,()=>s(n),b=>a(n,b)),H(q,()=>s(t),b=>a(t,b)),k(u,j),O()}K(["click"]);const Re="https://mmouwjthtuydpibxfbkq.supabase.co",Ae="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1tb3V3anRodHV5ZHBpYnhmYmtxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NTYwNzcsImV4cCI6MjA4NjUzMjA3N30.e-Aed6B6ZiXmJ94GujPqMXiIDKLmaRDqkUTXli-lAkc";async function De(u){const{data:{session:o}}=await L.auth.getSession();if(!o)throw new Error("Not authenticated");const n=new FormData;n.append("audio",u,"audio.webm");const t=await fetch(`${Re}/functions/v1/transcribe`,{method:"POST",headers:{Authorization:`Bearer ${o.access_token}`,apikey:Ae},body:n}),e=await t.text();if(!t.ok){let d;try{d=JSON.parse(e).error}catch{d=e}throw new Error(d||`HTTP ${t.status}`)}const{text:l}=JSON.parse(e);return l}const re=window.SpeechRecognition||window.webkitSpeechRecognition;function Be(){return!!re}function Ne({onResult:u,onEnd:o,onError:n}){if(!re)return n?.("Speech recognition is not supported in this browser."),null;const t=new re;return t.continuous=!0,t.interimResults=!0,t.lang="en-US",t.onresult=e=>{let l="",d="";for(let f=0;f<e.results.length;f++){const j=e.results[f][0].transcript;e.results[f].isFinal?l+=j:d+=j}u?.(l+d)},t.onend=()=>{o?.()},t.onerror=e=>{e.error!=="aborted"&&n?.(e.error)},{start(){t.start()},stop(){t.stop()},abort(){t.abort()}}}var Ue=x('<div class="saved-flash svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><polyline points="20 6 9 17 4 12" class="svelte-1qh7tkx"></polyline></svg> <p class="svelte-1qh7tkx">Saved!</p></div>'),Le=x('<div class="transcribing-view svelte-1qh7tkx"><div class="spinner-large svelte-1qh7tkx"></div> <p class="mic-label svelte-1qh7tkx">Transcribing...</p></div>'),Pe=x('<div class="input-area svelte-1qh7tkx"><input type="text" class="event-input svelte-1qh7tkx" placeholder="Tap mic to dictate..." enterkeyhint="done"/> <button class="save-btn svelte-1qh7tkx"> </button></div> <button class="mic-btn svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></button> <p class="hint svelte-1qh7tkx"> </p>',1),Oe=x('<p class="error svelte-1qh7tkx"> </p>'),Je=x('<div class="modal-overlay svelte-1qh7tkx"><div class="modal svelte-1qh7tkx"><div class="modal-mic recording svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></div> <p class="modal-label svelte-1qh7tkx">Recording...</p> <div class="modal-buttons svelte-1qh7tkx"><button class="modal-btn cancel svelte-1qh7tkx">Cancel</button> <button class="modal-btn stop svelte-1qh7tkx">Stop</button></div></div></div>'),We=x('<div class="record-view svelte-1qh7tkx"><button class="logout-btn svelte-1qh7tkx">Logout</button> <!> <!> <div class="version-row svelte-1qh7tkx"><button class="update-btn svelte-1qh7tkx">Update</button> <span class="svelte-1qh7tkx"></span></div></div> <!>',1);function Ve(u,o){P(o,!0);async function n(){await L.auth.signOut()}let t=y(""),e=y("idle"),l=y(""),d=!1,f=y(!1),j=y(!1),S=null,_=[],g=null,m=null;F(()=>{_e().then(r=>{a(f,r?.is_premium??!1,!0),a(j,!0),C()}).catch(()=>{a(j,!0),C()})});function C(){a(l,""),a(t,""),d=!1,s(f)?q():D()}function R(){s(f)?S?.stop():m?.stop()}function I(){d=!0,s(f)?(g&&g.getTracks().forEach(r=>r.stop()),S?.stop()):m?.abort(),a(e,"idle")}async function q(){try{g=await navigator.mediaDevices.getUserMedia({audio:!0}),_=[],S=new MediaRecorder(g,{mimeType:"audio/webm"}),S.ondataavailable=r=>{r.data.size>0&&_.push(r.data)},S.onstop=async()=>{if(g.getTracks().forEach(r=>r.stop()),g=null,!d){a(e,"transcribing");try{const r=new Blob(_,{type:"audio/webm"}),E=await De(r);a(t,E,!0),a(e,"idle")}catch(r){a(l,`Transcription failed: ${r.message}`),a(e,"idle")}}},S.start(),a(e,"recording"),history.pushState({recording:!0},"")}catch(r){a(l,`Mic access denied: ${r.message}`)}}function D(){if(!Be()){a(l,"Speech recognition not supported in this browser");return}m=Ne({onResult(r){a(t,r,!0)},onEnd(){m=null,s(e)==="recording"&&a(e,"idle")},onError(r){a(l,`Speech error: ${r}`),a(e,"idle")}}),m&&(m.start(),a(e,"recording"),history.pushState({recording:!0},""))}F(()=>{function r(){s(e)==="recording"&&I()}return window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)});async function w(){if("serviceWorker"in navigator){const r=await navigator.serviceWorker.getRegistration();if(r){await r.unregister();const E=await caches.keys();await Promise.all(E.map(B=>caches.delete(B)))}}location.reload()}async function T(){if(s(t).trim()){a(e,"saving"),a(l,"");try{await ge(s(t).trim()),a(e,"saved"),a(t,""),setTimeout(()=>{a(e,"idle")},1200)}catch(r){a(l,`Save failed: ${r.message}`),a(e,"idle")}}}var i=We(),c=G(i),h=v(c);h.__click=n;var b=p(h,2);{var z=r=>{var E=Ue();k(r,E)},J=r=>{var E=Le();k(r,E)},Q=r=>{var E=Pe(),B=G(E),W=v(B);W.__keydown=V=>V.key==="Enter"&&T();var U=p(W,2);U.__click=T;var ae=v(U),se=p(B,2);se.__click=C;var ve=p(se,2),de=v(ve);N(V=>{U.disabled=V,M(ae,s(e)==="saving"?"...":"Save"),se.disabled=s(e)==="saving",M(de,s(f)?"Whisper":"Web Speech API")},[()=>!s(t).trim()||s(e)==="saving"]),H(W,()=>s(t),V=>a(t,V)),k(r,E)};A(b,r=>{s(e)==="saved"?r(z):s(e)==="transcribing"?r(J,1):r(Q,!1)})}var Y=p(b,2);{var X=r=>{var E=Oe(),B=v(E);N(()=>M(B,s(l))),k(r,E)};A(Y,r=>{s(l)&&r(X)})}var $=p(Y,2),Z=v($);Z.__click=w;var ee=p(Z,2);ee.textContent="v9";var te=p(c,2);{var ce=r=>{var E=Je(),B=v(E),W=p(v(B),4),U=v(W);U.__click=I;var ae=p(U,2);ae.__click=R,k(r,E)};A(te,r=>{s(e)==="recording"&&r(ce)})}k(u,i),O()}K(["click","keydown"]);var He=x('<div class="delete-confirm svelte-1z0u85a"><p class="svelte-1z0u85a">Delete this record?</p> <div class="confirm-buttons svelte-1z0u85a"><button class="btn btn-danger svelte-1z0u85a">Delete</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),Ye=x('<div class="edit-form svelte-1z0u85a"><input type="text" class="edit-input svelte-1z0u85a"/> <div class="edit-buttons svelte-1z0u85a"><button class="btn btn-primary svelte-1z0u85a">Save</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),Xe=x('<div class="card-content svelte-1z0u85a"><div class="card-text svelte-1z0u85a"><span class="keywords svelte-1z0u85a"> </span> <span class="timestamp svelte-1z0u85a"> <span class="exact svelte-1z0u85a"> </span></span></div> <div class="card-actions svelte-1z0u85a"><button class="icon-btn svelte-1z0u85a" aria-label="Edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button> <button class="icon-btn delete svelte-1z0u85a" aria-label="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></div></div>'),Ze=x('<div class="card svelte-1z0u85a"><!></div>');function Fe(u,o){P(o,!0);let n=y(!1),t=y(""),e=y(!1);function l(){a(t,o.event.keywords,!0),a(n,!0)}async function d(){s(t).trim()&&(await o.onUpdate(o.event.id,s(t).trim()),a(n,!1))}function f(){a(n,!1)}function j(){a(e,!0)}async function S(){await o.onDelete(o.event.id),a(e,!1)}function _(){a(e,!1)}function g(w){const i=Date.now()-new Date(w).getTime(),c=Math.floor(i/6e4),h=Math.floor(i/36e5),b=Math.floor(i/864e5);return c<1?"just now":c<60?`${c}m ago`:h<24?`${h}h ago`:b<30?`${b}d ago`:`${Math.floor(b/30)}mo ago`}function m(w){return new Date(w).toLocaleString()}var C=Ze(),R=v(C);{var I=w=>{var T=He(),i=p(v(T),2),c=v(i);c.__click=S;var h=p(c,2);h.__click=_,k(w,T)},q=w=>{var T=Ye(),i=v(T);i.__keydown=z=>z.key==="Enter"&&d();var c=p(i,2),h=v(c);h.__click=d;var b=p(h,2);b.__click=f,H(i,()=>s(t),z=>a(t,z)),k(w,T)},D=w=>{var T=Xe(),i=v(T),c=v(i),h=v(c),b=p(c,2),z=v(b),J=p(z),Q=v(J),Y=p(i,2),X=v(Y);X.__click=l;var $=p(X,2);$.__click=j,N((Z,ee,te)=>{M(h,o.event.keywords),le(b,"title",Z),M(z,`${ee??""} `),M(Q,te)},[()=>m(o.event.timestamp),()=>g(o.event.timestamp),()=>m(o.event.timestamp)]),k(w,T)};A(R,w=>{s(e)?w(I):s(n)?w(q,1):w(D,!1)})}k(u,C),O()}K(["click","keydown"]);var Ge=x('<p class="error svelte-1kklj14"> </p>'),Ke=x('<p class="status svelte-1kklj14">Loading...</p>'),Qe=x('<p class="status svelte-1kklj14"> </p>'),$e=x('<div class="search-view svelte-1kklj14"><div class="search-bar svelte-1kklj14"><svg class="search-icon svelte-1kklj14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" class="search-input svelte-1kklj14" placeholder="Search events..."/></div> <!> <div class="results"><!></div></div>');function et(u,o){P(o,!0);let n=y(""),t=y(ke([])),e=y(!1),l=y(""),d=null;F(()=>{clearTimeout(d);const i=s(n);return d=setTimeout(()=>f(i),300),()=>clearTimeout(d)});async function f(i){a(e,!0),a(l,"");try{a(t,await me(i),!0)}catch(c){a(l,c.message,!0)}a(e,!1)}async function j(i,c){try{await xe(i,c),a(t,s(t).map(h=>h.id===i?{...h,keywords:c}:h),!0)}catch(h){a(l,h.message,!0)}}async function S(i){try{await we(i),a(t,s(t).filter(c=>c.id!==i),!0)}catch(c){a(l,c.message,!0)}}var _=$e(),g=v(_),m=p(v(g),2),C=p(g,2);{var R=i=>{var c=Ge(),h=v(c);N(()=>M(h,s(l))),k(i,c)};A(C,i=>{s(l)&&i(R)})}var I=p(C,2),q=v(I);{var D=i=>{var c=Ke();k(i,c)},w=i=>{var c=Qe(),h=v(c);N(()=>M(h,s(n)?"No results found":"No events yet")),k(i,c)},T=i=>{var c=oe(),h=G(c);ye(h,17,()=>s(t),b=>b.id,(b,z)=>{Fe(b,{get event(){return s(z)},onUpdate:j,onDelete:S})}),k(i,c)};A(q,i=>{s(e)&&s(t).length===0?i(D):s(t).length===0?i(w,1):i(T,!1)})}H(m,()=>s(n),i=>a(n,i)),k(u,_),O()}var tt=x('<nav class="tab-bar svelte-1n51new"><button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <span>Record</span></button> <button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <span>Search</span></button></nav>');function at(u,o){P(o,!0);let n=Ee(o,"activeTab",3,"record");var t=tt(),e=v(t);let l;e.__click=()=>o.onTabChange("record");var d=p(e,2);let f;d.__click=()=>o.onTabChange("search"),N(()=>{l=ne(e,1,"tab svelte-1n51new",null,l,{active:n()==="record"}),f=ne(d,1,"tab svelte-1n51new",null,f,{active:n()==="search"})}),k(u,t),O()}K(["click"]);var st=x('<div class="loading svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div></div>'),rt=x('<main class="app svelte-1n46o8q"><!> <!></main>');function nt(u,o){P(o,!0);let n=y(null),t=y(!0),e=y("record");F(()=>{L.auth.getSession().then(({data:{session:g}})=>{a(n,g,!0),a(t,!1)});const{data:{subscription:_}}=L.auth.onAuthStateChange((g,m)=>{a(n,m,!0)});return()=>_.unsubscribe()});var l=oe(),d=G(l);{var f=_=>{var g=st();k(_,g)},j=_=>{Ie(_,{})},S=_=>{var g=rt(),m=v(g);{var C=q=>{Ve(q,{})},R=q=>{et(q,{})};A(m,q=>{s(e)==="record"?q(C):q(R,!1)})}var I=p(m,2);at(I,{get activeTab(){return s(e)},onTabChange:q=>a(e,q,!0)}),k(_,g)};A(d,_=>{s(t)?_(f):s(n)?_(S,!1):_(j,1)})}k(u,l),O()}Se(nt,{target:document.getElementById("app")});"serviceWorker"in navigator&&navigator.serviceWorker.register("/noted/sw.js");
