import{N as fe,g as he,a as _e,L as me,c as be,u as G,b as ge,d as K,p as P,i as A,e as a,s as t,t as N,f as ke,h as V,j as b,k as J,l as y,m as d,n as p,o as x,q as M,r as H,v as Z,w as we,x as ye,y as xe,z as Se,A as oe,B as qe,C as je,D as Ee,E as re,F as Te}from"./profiles-DZXIJCqh.js";function ze(v){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}const Ce=Symbol("is custom element"),Me=Symbol("is html");function le(v,r,i,s){var e=Ie(v);e[r]!==(e[r]=i)&&(r==="loading"&&(v[me]=i),i==null?v.removeAttribute(r):typeof i!="string"&&Re(v).includes(r)?v[r]=i:v.setAttribute(r,i))}function Ie(v){return v.__attributes??={[Ce]:v.nodeName.includes("-"),[Me]:v.namespaceURI===fe}}var ie=new Map;function Re(v){var r=v.getAttribute("is")||v.nodeName,i=ie.get(r);if(i)return i;ie.set(r,i=[]);for(var s,e=v,l=Element.prototype;l!==e;){s=_e(e);for(var u in s)s[u].set&&i.push(u);e=he(e)}return i}function Ae(v,r,i,s){var e=s,l=!0,u=()=>(l&&(l=!1,e=s),e),f;f=v[r],f===void 0&&s!==void 0&&(f=u());var q;return q=()=>{var j=v[r];return j===void 0?u():(l=!0,j)},q}function De(v){be===null&&ze(),G(()=>{const r=ge(v);if(typeof r=="function")return r})}var Be=x('<p class="error svelte-15ijoy3"> </p>'),Ne=x('<div class="login-container svelte-15ijoy3"><div class="login-header svelte-15ijoy3"><svg class="logo svelte-15ijoy3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <h1 class="svelte-15ijoy3">Noted.</h1> <p class="subtitle svelte-15ijoy3"> </p></div> <form autocomplete="on" class="svelte-15ijoy3"><div class="field svelte-15ijoy3"><input type="email" name="email" autocomplete="username" placeholder="Email" required="" class="svelte-15ijoy3"/></div> <div class="field svelte-15ijoy3"><input type="password" name="password" placeholder="Password" required="" minlength="6" class="svelte-15ijoy3"/></div> <!> <button type="submit" class="submit-btn svelte-15ijoy3"> </button></form> <button class="toggle-btn svelte-15ijoy3"> </button></div>');function Ue(v,r){P(r,!0);let i=y(""),s=y(""),e=y(!1),l=y(!1),u=y("");async function f(_){_.preventDefault(),t(l,!0),t(u,"");const{error:z}=a(e)?await H.auth.signUp({email:a(i),password:a(s),options:{emailRedirectTo:"https://imtjls3t.github.io/noted/"}}):await H.auth.signInWithPassword({email:a(i),password:a(s)});z?t(u,z.message,!0):a(e)&&t(u,"Check your email for a confirmation link."),t(l,!1)}var q=Ne(),j=d(q),m=p(d(j),4),g=d(m),k=p(j,2),C=d(k),R=d(C),I=p(C,2),E=d(I),D=p(I,2);{var S=_=>{var z=Be(),U=d(z);N(()=>M(U,a(u))),b(_,z)};A(D,_=>{a(u)&&_(S)})}var T=p(D,2),o=d(T),c=p(k,2);c.__click=()=>{t(e,!a(e)),t(u,"")};var h=d(c);N(()=>{M(g,a(e)?"Create an account":"Sign in to continue"),R.disabled=a(l),le(E,"autocomplete",a(e)?"new-password":"current-password"),E.disabled=a(l),T.disabled=a(l),M(o,a(l)?"...":a(e)?"Sign Up":"Sign In"),M(h,a(e)?"Already have an account? Sign in":"Don't have an account? Sign up")}),ke("submit",k,f),V(R,()=>a(i),_=>t(i,_)),V(E,()=>a(s),_=>t(s,_)),b(v,q),J()}K(["click"]);const Le="https://mmouwjthtuydpibxfbkq.supabase.co",Pe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1tb3V3anRodHV5ZHBpYnhmYmtxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NTYwNzcsImV4cCI6MjA4NjUzMjA3N30.e-Aed6B6ZiXmJ94GujPqMXiIDKLmaRDqkUTXli-lAkc";async function Je(v){const{data:{session:r}}=await H.auth.getSession();if(!r)throw new Error("Not authenticated");const i=new FormData;i.append("audio",v,"audio.webm");const s=await fetch(`${Le}/functions/v1/transcribe`,{method:"POST",headers:{Authorization:`Bearer ${r.access_token}`,apikey:Pe},body:i}),e=await s.text();if(!s.ok){let u;try{u=JSON.parse(e).error}catch{u=e}throw new Error(u||`HTTP ${s.status}`)}const{text:l}=JSON.parse(e);return l}const ne=window.SpeechRecognition||window.webkitSpeechRecognition;function Oe(){return!!ne}function We({onResult:v,onEnd:r,onError:i}){if(!ne)return i?.("Speech recognition is not supported in this browser."),null;const s=new ne;return s.continuous=!0,s.interimResults=!0,s.lang="en-US",s.onresult=e=>{let l="",u="";for(let f=0;f<e.results.length;f++){const q=e.results[f][0].transcript;e.results[f].isFinal?l+=q:u+=q}v?.(l+u)},s.onend=()=>{r?.()},s.onerror=e=>{e.error!=="aborted"&&i?.(e.error)},{start(){s.start()},stop(){s.stop()},abort(){s.abort()}}}var Ve=x('<p class="confirmed svelte-1qh7tkx">Email confirmed</p>'),He=x('<div class="saved-flash svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><polyline points="20 6 9 17 4 12" class="svelte-1qh7tkx"></polyline></svg> <p class="svelte-1qh7tkx">Saved!</p></div>'),Ye=x('<div class="transcribing-view svelte-1qh7tkx"><div class="spinner-large svelte-1qh7tkx"></div> <p class="mic-label svelte-1qh7tkx">Transcribing...</p></div>'),Xe=x('<div class="input-area svelte-1qh7tkx"><input type="text" class="event-input svelte-1qh7tkx" placeholder="Tap mic to dictate..." enterkeyhint="done"/> <button class="save-btn svelte-1qh7tkx"> </button></div> <button class="mic-btn svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></button> <p class="hint svelte-1qh7tkx"> </p>',1),Fe=x('<p class="error svelte-1qh7tkx"> </p>'),Ze=x('<div class="modal-overlay svelte-1qh7tkx"><div class="modal svelte-1qh7tkx"><div class="modal-mic recording svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></div> <p class="modal-label svelte-1qh7tkx">Recording...</p> <div class="modal-buttons svelte-1qh7tkx"><button class="modal-btn cancel svelte-1qh7tkx">Cancel</button> <button class="modal-btn stop svelte-1qh7tkx">Stop</button></div></div></div>'),Ge=x('<div class="record-view svelte-1qh7tkx"><button class="logout-btn svelte-1qh7tkx">Logout</button> <!> <!> <!> <div class="version-row svelte-1qh7tkx"><button class="update-btn svelte-1qh7tkx">Update</button> <span class="svelte-1qh7tkx"></span></div></div> <!>',1);function Ke(v,r){P(r,!0);function i(){window.location.href="/noted/logout"}let s=y(""),e=y("idle"),l=y(""),u=!1,f=y(!1),q=y(!1),j=null,m=[],g=null,k=null;De(async()=>{const n=window.location.hash.includes("access_token");n&&(window.history.replaceState(null,"",window.location.pathname),t(q,!0),setTimeout(()=>{t(q,!1)},5e3));try{const w=await ye();t(f,w?.is_premium??!1,!0)}catch{t(f,!1)}n||C()});function C(){t(l,""),t(s,""),u=!1,a(f)?E():D()}function R(){a(f)?j?.stop():k?.stop()}function I(){u=!0,a(f)?(g&&g.getTracks().forEach(n=>n.stop()),j?.stop()):k?.abort(),t(e,"idle")}async function E(){try{g=await navigator.mediaDevices.getUserMedia({audio:!0}),m=[],j=new MediaRecorder(g,{mimeType:"audio/webm"}),j.ondataavailable=n=>{n.data.size>0&&m.push(n.data)},j.onstop=async()=>{if(g.getTracks().forEach(n=>n.stop()),g=null,!u){t(e,"transcribing");try{const n=new Blob(m,{type:"audio/webm"}),w=await Je(n);t(s,w,!0),t(e,"idle")}catch(n){t(l,`Transcription failed: ${n.message}`),t(e,"idle")}}},j.start(),t(e,"recording"),history.pushState({recording:!0},"")}catch(n){t(l,`Mic access denied: ${n.message}`)}}function D(){if(!Oe()){t(l,"Speech recognition not supported in this browser");return}k=We({onResult(n){t(s,n,!0)},onEnd(){k=null,a(e)==="recording"&&t(e,"idle")},onError(n){t(l,`Speech error: ${n}`),t(e,"idle")}}),k&&(k.start(),t(e,"recording"),history.pushState({recording:!0},""))}G(()=>{function n(){a(e)==="recording"&&I()}return window.addEventListener("popstate",n),()=>window.removeEventListener("popstate",n)});async function S(){if("serviceWorker"in navigator){const n=await navigator.serviceWorker.getRegistration();if(n){await n.unregister();const w=await caches.keys();await Promise.all(w.map(B=>caches.delete(B)))}}location.reload()}async function T(){if(a(s).trim()){t(e,"saving"),t(l,"");try{await we(a(s).trim()),t(e,"saved"),t(s,""),setTimeout(()=>{t(e,"idle")},1200)}catch(n){t(l,`Save failed: ${n.message}`),t(e,"idle")}}}var o=Ge(),c=Z(o),h=d(c);h.__click=i;var _=p(h,2);{var z=n=>{var w=Ve();b(n,w)};A(_,n=>{a(q)&&n(z)})}var U=p(_,2);{var Q=n=>{var w=He();b(n,w)},$=n=>{var w=Ye();b(n,w)},Y=n=>{var w=Xe(),B=Z(w),O=d(B);O.__keydown=W=>W.key==="Enter"&&T();var L=p(O,2);L.__click=T;var ae=d(L),se=p(B,2);se.__click=C;var ue=p(se,2),pe=d(ue);N(W=>{L.disabled=W,M(ae,a(e)==="saving"?"...":"Save"),se.disabled=a(e)==="saving",M(pe,a(f)?"Whisper":"Web Speech API")},[()=>!a(s).trim()||a(e)==="saving"]),V(O,()=>a(s),W=>t(s,W)),b(n,w)};A(U,n=>{a(e)==="saved"?n(Q):a(e)==="transcribing"?n($,1):n(Y,!1)})}var X=p(U,2);{var ee=n=>{var w=Fe(),B=d(w);N(()=>M(B,a(l))),b(n,w)};A(X,n=>{a(l)&&n(ee)})}var te=p(X,2),F=d(te);F.__click=S;var ce=p(F,2);ce.textContent="v9";var ve=p(c,2);{var de=n=>{var w=Ze(),B=d(w),O=p(d(B),4),L=d(O);L.__click=I;var ae=p(L,2);ae.__click=R,b(n,w)};A(ve,n=>{a(e)==="recording"&&n(de)})}b(v,o),J()}K(["click","keydown"]);var Qe=x('<div class="delete-confirm svelte-1z0u85a"><p class="svelte-1z0u85a">Delete this record?</p> <div class="confirm-buttons svelte-1z0u85a"><button class="btn btn-danger svelte-1z0u85a">Delete</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),$e=x('<div class="edit-form svelte-1z0u85a"><input type="text" class="edit-input svelte-1z0u85a"/> <div class="edit-buttons svelte-1z0u85a"><button class="btn btn-primary svelte-1z0u85a">Save</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),et=x('<div class="card-content svelte-1z0u85a"><div class="card-text svelte-1z0u85a"><span class="keywords svelte-1z0u85a"> </span> <span class="timestamp svelte-1z0u85a"> <span class="exact svelte-1z0u85a"> </span></span></div> <div class="card-actions svelte-1z0u85a"><button class="icon-btn svelte-1z0u85a" aria-label="Edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button> <button class="icon-btn delete svelte-1z0u85a" aria-label="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></div></div>'),tt=x('<div class="card svelte-1z0u85a"><!></div>');function at(v,r){P(r,!0);let i=y(!1),s=y(""),e=y(!1);function l(){t(s,r.event.keywords,!0),t(i,!0)}async function u(){a(s).trim()&&(await r.onUpdate(r.event.id,a(s).trim()),t(i,!1))}function f(){t(i,!1)}function q(){t(e,!0)}async function j(){await r.onDelete(r.event.id),t(e,!1)}function m(){t(e,!1)}function g(S){const o=Date.now()-new Date(S).getTime(),c=Math.floor(o/6e4),h=Math.floor(o/36e5),_=Math.floor(o/864e5);return c<1?"just now":c<60?`${c}m ago`:h<24?`${h}h ago`:_<30?`${_}d ago`:`${Math.floor(_/30)}mo ago`}function k(S){return new Date(S).toLocaleString()}var C=tt(),R=d(C);{var I=S=>{var T=Qe(),o=p(d(T),2),c=d(o);c.__click=j;var h=p(c,2);h.__click=m,b(S,T)},E=S=>{var T=$e(),o=d(T);o.__keydown=z=>z.key==="Enter"&&u();var c=p(o,2),h=d(c);h.__click=u;var _=p(h,2);_.__click=f,V(o,()=>a(s),z=>t(s,z)),b(S,T)},D=S=>{var T=et(),o=d(T),c=d(o),h=d(c),_=p(c,2),z=d(_),U=p(z),Q=d(U),$=p(o,2),Y=d($);Y.__click=l;var X=p(Y,2);X.__click=q,N((ee,te,F)=>{M(h,r.event.keywords),le(_,"title",ee),M(z,`${te??""} `),M(Q,F)},[()=>k(r.event.timestamp),()=>g(r.event.timestamp),()=>k(r.event.timestamp)]),b(S,T)};A(R,S=>{a(e)?S(I):a(i)?S(E,1):S(D,!1)})}b(v,C),J()}K(["click","keydown"]);var st=x('<p class="error svelte-1kklj14"> </p>'),nt=x('<p class="status svelte-1kklj14">Loading...</p>'),rt=x('<p class="status svelte-1kklj14"> </p>'),it=x('<div class="search-view svelte-1kklj14"><div class="search-bar svelte-1kklj14"><svg class="search-icon svelte-1kklj14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" class="search-input svelte-1kklj14" placeholder="Search events..."/></div> <!> <div class="results"><!></div></div>');function ot(v,r){P(r,!0);let i=y(""),s=y(xe([])),e=y(!1),l=y(""),u=null;G(()=>{clearTimeout(u);const o=a(i);return u=setTimeout(()=>f(o),300),()=>clearTimeout(u)});async function f(o){t(e,!0),t(l,"");try{t(s,await Se(o),!0)}catch(c){t(l,c.message,!0)}t(e,!1)}async function q(o,c){try{await Ee(o,c),t(s,a(s).map(h=>h.id===o?{...h,keywords:c}:h),!0)}catch(h){t(l,h.message,!0)}}async function j(o){try{await je(o),t(s,a(s).filter(c=>c.id!==o),!0)}catch(c){t(l,c.message,!0)}}var m=it(),g=d(m),k=p(d(g),2),C=p(g,2);{var R=o=>{var c=st(),h=d(c);N(()=>M(h,a(l))),b(o,c)};A(C,o=>{a(l)&&o(R)})}var I=p(C,2),E=d(I);{var D=o=>{var c=nt();b(o,c)},S=o=>{var c=rt(),h=d(c);N(()=>M(h,a(i)?"No results found":"No events yet")),b(o,c)},T=o=>{var c=oe(),h=Z(c);qe(h,17,()=>a(s),_=>_.id,(_,z)=>{at(_,{get event(){return a(z)},onUpdate:q,onDelete:j})}),b(o,c)};A(E,o=>{a(e)&&a(s).length===0?o(D):a(s).length===0?o(S,1):o(T,!1)})}V(k,()=>a(i),o=>t(i,o)),b(v,m),J()}var lt=x('<nav class="tab-bar svelte-1n51new"><button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <span>Record</span></button> <button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <span>Search</span></button></nav>');function ct(v,r){P(r,!0);let i=Ae(r,"activeTab",3,"record");var s=lt(),e=d(s);let l;e.__click=()=>r.onTabChange("record");var u=p(e,2);let f;u.__click=()=>r.onTabChange("search"),N(()=>{l=re(e,1,"tab svelte-1n51new",null,l,{active:i()==="record"}),f=re(u,1,"tab svelte-1n51new",null,f,{active:i()==="search"})}),b(v,s),J()}K(["click"]);var vt=x('<div class="loading svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div></div>'),dt=x('<main class="app svelte-1n46o8q"><!> <!></main>');function ut(v,r){P(r,!0);let i=y(null),s=y(!0),e=y("record");G(()=>{H.auth.getSession().then(({data:{session:g}})=>{t(i,g,!0),t(s,!1)});const{data:{subscription:m}}=H.auth.onAuthStateChange((g,k)=>{t(i,k,!0)});return()=>m.unsubscribe()});var l=oe(),u=Z(l);{var f=m=>{var g=vt();b(m,g)},q=m=>{Ue(m,{})},j=m=>{var g=dt(),k=d(g);{var C=E=>{Ke(E,{})},R=E=>{ot(E,{})};A(k,E=>{a(e)==="record"?E(C):E(R,!1)})}var I=p(k,2);ct(I,{get activeTab(){return a(e)},onTabChange:E=>t(e,E,!0)}),b(m,g)};A(u,m=>{a(s)?m(f):a(i)?m(j,!1):m(q,1)})}b(v,l),J()}Te(ut,{target:document.getElementById("app")});"serviceWorker"in navigator&&navigator.serviceWorker.register("/noted/sw.js");
