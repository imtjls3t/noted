import{N as ue,g as de,a as pe,L as he,c as fe,u as G,b as _e,d as K,p as P,i as A,e as a,s,t as N,f as be,h as H,j as m,k as O,l as w,m as u,n as p,o as x,q as C,r as L,v as Z,w as ge,x as ke,y as me,z as ye,A as oe,B as we,C as xe,D as Se,E as re,F as qe}from"./profiles-DNT2HGIN.js";function je(v){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}const Ee=Symbol("is custom element"),Te=Symbol("is html");function le(v,n,i,t){var e=ze(v);e[n]!==(e[n]=i)&&(n==="loading"&&(v[he]=i),i==null?v.removeAttribute(n):typeof i!="string"&&Me(v).includes(n)?v[n]=i:v.setAttribute(n,i))}function ze(v){return v.__attributes??={[Ee]:v.nodeName.includes("-"),[Te]:v.namespaceURI===ue}}var ie=new Map;function Me(v){var n=v.getAttribute("is")||v.nodeName,i=ie.get(n);if(i)return i;ie.set(n,i=[]);for(var t,e=v,l=Element.prototype;l!==e;){t=pe(e);for(var d in t)t[d].set&&i.push(d);e=de(e)}return i}function Ce(v,n,i,t){var e=t,l=!0,d=()=>(l&&(l=!1,e=t),e),h;h=v[n],h===void 0&&t!==void 0&&(h=d());var g;return g=()=>{var z=v[n];return z===void 0?d():(l=!0,z)},g}function Ie(v){fe===null&&je(),G(()=>{const n=_e(v);if(typeof n=="function")return n})}var Re=x('<p class="error svelte-15ijoy3"> </p>'),Ae=x('<div class="login-container svelte-15ijoy3"><div class="login-header svelte-15ijoy3"><svg class="logo svelte-15ijoy3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <h1 class="svelte-15ijoy3">Noted.</h1> <p class="subtitle svelte-15ijoy3"> </p></div> <form autocomplete="on" class="svelte-15ijoy3"><div class="field svelte-15ijoy3"><input type="email" name="email" autocomplete="username" placeholder="Email" required="" class="svelte-15ijoy3"/></div> <div class="field svelte-15ijoy3"><input type="password" name="password" placeholder="Password" required="" minlength="6" class="svelte-15ijoy3"/></div> <!> <button type="submit" class="submit-btn svelte-15ijoy3"> </button></form> <button class="toggle-btn svelte-15ijoy3"> </button></div>');function De(v,n){P(n,!0);let i=w(""),t=w(""),e=w(!1),l=w(!1),d=w("");async function h(b){b.preventDefault(),s(l,!0),s(d,"");const{error:E}=a(e)?await L.auth.signUp({email:a(i),password:a(t),options:{emailRedirectTo:"https://imtjls3t.github.io/noted/"}}):await L.auth.signInWithPassword({email:a(i),password:a(t)});E?s(d,E.message,!0):a(e)&&s(d,"Check your email for a confirmation link."),s(l,!1)}var g=Ae(),z=u(g),_=p(u(z),4),k=u(_),j=p(z,2),M=u(j),I=u(M),R=p(M,2),S=u(R),D=p(R,2);{var y=b=>{var E=Re(),J=u(E);N(()=>C(J,a(d))),m(b,E)};A(D,b=>{a(d)&&b(y)})}var q=p(D,2),o=u(q),c=p(j,2);c.__click=()=>{s(e,!a(e)),s(d,"")};var f=u(c);N(()=>{C(k,a(e)?"Create an account":"Sign in to continue"),I.disabled=a(l),le(S,"autocomplete",a(e)?"new-password":"current-password"),S.disabled=a(l),q.disabled=a(l),C(o,a(l)?"...":a(e)?"Sign Up":"Sign In"),C(f,a(e)?"Already have an account? Sign in":"Don't have an account? Sign up")}),be("submit",j,h),H(I,()=>a(i),b=>s(i,b)),H(S,()=>a(t),b=>s(t,b)),m(v,g),O()}K(["click"]);const Be="https://mmouwjthtuydpibxfbkq.supabase.co",Ne="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1tb3V3anRodHV5ZHBpYnhmYmtxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NTYwNzcsImV4cCI6MjA4NjUzMjA3N30.e-Aed6B6ZiXmJ94GujPqMXiIDKLmaRDqkUTXli-lAkc";async function Ue(v){const{data:{session:n}}=await L.auth.getSession();if(!n)throw new Error("Not authenticated");const i=new FormData;i.append("audio",v,"audio.webm");const t=await fetch(`${Be}/functions/v1/transcribe`,{method:"POST",headers:{Authorization:`Bearer ${n.access_token}`,apikey:Ne},body:i}),e=await t.text();if(!t.ok){let d;try{d=JSON.parse(e).error}catch{d=e}throw new Error(d||`HTTP ${t.status}`)}const{text:l}=JSON.parse(e);return l}const ne=window.SpeechRecognition||window.webkitSpeechRecognition;function Le(){return!!ne}function Pe({onResult:v,onEnd:n,onError:i}){if(!ne)return i?.("Speech recognition is not supported in this browser."),null;const t=new ne;return t.continuous=!0,t.interimResults=!0,t.lang="en-US",t.onresult=e=>{let l="",d="";for(let h=0;h<e.results.length;h++){const g=e.results[h][0].transcript;e.results[h].isFinal?l+=g:d+=g}v?.(l+d)},t.onend=()=>{n?.()},t.onerror=e=>{e.error!=="aborted"&&i?.(e.error)},{start(){t.start()},stop(){t.stop()},abort(){t.abort()}}}var Oe=x('<div class="saved-flash svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><polyline points="20 6 9 17 4 12" class="svelte-1qh7tkx"></polyline></svg> <p class="svelte-1qh7tkx">Saved!</p></div>'),Je=x('<div class="transcribing-view svelte-1qh7tkx"><div class="spinner-large svelte-1qh7tkx"></div> <p class="mic-label svelte-1qh7tkx">Transcribing...</p></div>'),We=x('<div class="input-area svelte-1qh7tkx"><input type="text" class="event-input svelte-1qh7tkx" placeholder="Tap mic to dictate..." enterkeyhint="done"/> <button class="save-btn svelte-1qh7tkx"> </button></div> <button class="mic-btn svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></button> <p class="hint svelte-1qh7tkx"> </p>',1),Ve=x('<p class="error svelte-1qh7tkx"> </p>'),He=x('<div class="modal-overlay svelte-1qh7tkx"><div class="modal svelte-1qh7tkx"><div class="modal-mic recording svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></div> <p class="modal-label svelte-1qh7tkx">Recording...</p> <div class="modal-buttons svelte-1qh7tkx"><button class="modal-btn cancel svelte-1qh7tkx">Cancel</button> <button class="modal-btn stop svelte-1qh7tkx">Stop</button></div></div></div>'),Ye=x('<div class="record-view svelte-1qh7tkx"><button class="logout-btn svelte-1qh7tkx">Logout</button> <!> <!> <div class="version-row svelte-1qh7tkx"><button class="update-btn svelte-1qh7tkx">Update</button> <span class="svelte-1qh7tkx"></span></div></div> <!>',1);function Xe(v,n){P(n,!0);async function i(){await L.auth.signOut()}let t=w(""),e=w("idle"),l=w(""),d=!1,h=w(!1),g=null,z=[],_=null,k=null;Ie(async()=>{try{const r=await ke();s(h,r?.is_premium??!1,!0)}catch{s(h,!1)}j()});function j(){s(l,""),s(t,""),d=!1,a(h)?R():S()}function M(){a(h)?g?.stop():k?.stop()}function I(){d=!0,a(h)?(_&&_.getTracks().forEach(r=>r.stop()),g?.stop()):k?.abort(),s(e,"idle")}async function R(){try{_=await navigator.mediaDevices.getUserMedia({audio:!0}),z=[],g=new MediaRecorder(_,{mimeType:"audio/webm"}),g.ondataavailable=r=>{r.data.size>0&&z.push(r.data)},g.onstop=async()=>{if(_.getTracks().forEach(r=>r.stop()),_=null,!d){s(e,"transcribing");try{const r=new Blob(z,{type:"audio/webm"}),T=await Ue(r);s(t,T,!0),s(e,"idle")}catch(r){s(l,`Transcription failed: ${r.message}`),s(e,"idle")}}},g.start(),s(e,"recording"),history.pushState({recording:!0},"")}catch(r){s(l,`Mic access denied: ${r.message}`)}}function S(){if(!Le()){s(l,"Speech recognition not supported in this browser");return}k=Pe({onResult(r){s(t,r,!0)},onEnd(){k=null,a(e)==="recording"&&s(e,"idle")},onError(r){s(l,`Speech error: ${r}`),s(e,"idle")}}),k&&(k.start(),s(e,"recording"),history.pushState({recording:!0},""))}G(()=>{function r(){a(e)==="recording"&&I()}return window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)});async function D(){if("serviceWorker"in navigator){const r=await navigator.serviceWorker.getRegistration();if(r){await r.unregister();const T=await caches.keys();await Promise.all(T.map(B=>caches.delete(B)))}}location.reload()}async function y(){if(a(t).trim()){s(e,"saving"),s(l,"");try{await ge(a(t).trim()),s(e,"saved"),s(t,""),setTimeout(()=>{s(e,"idle")},1200)}catch(r){s(l,`Save failed: ${r.message}`),s(e,"idle")}}}var q=Ye(),o=Z(q),c=u(o);c.__click=i;var f=p(c,2);{var b=r=>{var T=Oe();m(r,T)},E=r=>{var T=Je();m(r,T)},J=r=>{var T=We(),B=Z(T),W=u(B);W.__keydown=V=>V.key==="Enter"&&y();var U=p(W,2);U.__click=y;var ae=u(U),se=p(B,2);se.__click=j;var ce=p(se,2),ve=u(ce);N(V=>{U.disabled=V,C(ae,a(e)==="saving"?"...":"Save"),se.disabled=a(e)==="saving",C(ve,a(h)?"Whisper":"Web Speech API")},[()=>!a(t).trim()||a(e)==="saving"]),H(W,()=>a(t),V=>s(t,V)),m(r,T)};A(f,r=>{a(e)==="saved"?r(b):a(e)==="transcribing"?r(E,1):r(J,!1)})}var Y=p(f,2);{var Q=r=>{var T=Ve(),B=u(T);N(()=>C(B,a(l))),m(r,T)};A(Y,r=>{a(l)&&r(Q)})}var X=p(Y,2),F=u(X);F.__click=D;var $=p(F,2);$.textContent="v9";var ee=p(o,2);{var te=r=>{var T=He(),B=u(T),W=p(u(B),4),U=u(W);U.__click=I;var ae=p(U,2);ae.__click=M,m(r,T)};A(ee,r=>{a(e)==="recording"&&r(te)})}m(v,q),O()}K(["click","keydown"]);var Fe=x('<div class="delete-confirm svelte-1z0u85a"><p class="svelte-1z0u85a">Delete this record?</p> <div class="confirm-buttons svelte-1z0u85a"><button class="btn btn-danger svelte-1z0u85a">Delete</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),Ze=x('<div class="edit-form svelte-1z0u85a"><input type="text" class="edit-input svelte-1z0u85a"/> <div class="edit-buttons svelte-1z0u85a"><button class="btn btn-primary svelte-1z0u85a">Save</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),Ge=x('<div class="card-content svelte-1z0u85a"><div class="card-text svelte-1z0u85a"><span class="keywords svelte-1z0u85a"> </span> <span class="timestamp svelte-1z0u85a"> <span class="exact svelte-1z0u85a"> </span></span></div> <div class="card-actions svelte-1z0u85a"><button class="icon-btn svelte-1z0u85a" aria-label="Edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button> <button class="icon-btn delete svelte-1z0u85a" aria-label="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></div></div>'),Ke=x('<div class="card svelte-1z0u85a"><!></div>');function Qe(v,n){P(n,!0);let i=w(!1),t=w(""),e=w(!1);function l(){s(t,n.event.keywords,!0),s(i,!0)}async function d(){a(t).trim()&&(await n.onUpdate(n.event.id,a(t).trim()),s(i,!1))}function h(){s(i,!1)}function g(){s(e,!0)}async function z(){await n.onDelete(n.event.id),s(e,!1)}function _(){s(e,!1)}function k(y){const o=Date.now()-new Date(y).getTime(),c=Math.floor(o/6e4),f=Math.floor(o/36e5),b=Math.floor(o/864e5);return c<1?"just now":c<60?`${c}m ago`:f<24?`${f}h ago`:b<30?`${b}d ago`:`${Math.floor(b/30)}mo ago`}function j(y){return new Date(y).toLocaleString()}var M=Ke(),I=u(M);{var R=y=>{var q=Fe(),o=p(u(q),2),c=u(o);c.__click=z;var f=p(c,2);f.__click=_,m(y,q)},S=y=>{var q=Ze(),o=u(q);o.__keydown=E=>E.key==="Enter"&&d();var c=p(o,2),f=u(c);f.__click=d;var b=p(f,2);b.__click=h,H(o,()=>a(t),E=>s(t,E)),m(y,q)},D=y=>{var q=Ge(),o=u(q),c=u(o),f=u(c),b=p(c,2),E=u(b),J=p(E),Y=u(J),Q=p(o,2),X=u(Q);X.__click=l;var F=p(X,2);F.__click=g,N(($,ee,te)=>{C(f,n.event.keywords),le(b,"title",$),C(E,`${ee??""} `),C(Y,te)},[()=>j(n.event.timestamp),()=>k(n.event.timestamp),()=>j(n.event.timestamp)]),m(y,q)};A(I,y=>{a(e)?y(R):a(i)?y(S,1):y(D,!1)})}m(v,M),O()}K(["click","keydown"]);var $e=x('<p class="error svelte-1kklj14"> </p>'),et=x('<p class="status svelte-1kklj14">Loading...</p>'),tt=x('<p class="status svelte-1kklj14"> </p>'),at=x('<div class="search-view svelte-1kklj14"><div class="search-bar svelte-1kklj14"><svg class="search-icon svelte-1kklj14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" class="search-input svelte-1kklj14" placeholder="Search events..."/></div> <!> <div class="results"><!></div></div>');function st(v,n){P(n,!0);let i=w(""),t=w(me([])),e=w(!1),l=w(""),d=null;G(()=>{clearTimeout(d);const o=a(i);return d=setTimeout(()=>h(o),300),()=>clearTimeout(d)});async function h(o){s(e,!0),s(l,"");try{s(t,await ye(o),!0)}catch(c){s(l,c.message,!0)}s(e,!1)}async function g(o,c){try{await Se(o,c),s(t,a(t).map(f=>f.id===o?{...f,keywords:c}:f),!0)}catch(f){s(l,f.message,!0)}}async function z(o){try{await xe(o),s(t,a(t).filter(c=>c.id!==o),!0)}catch(c){s(l,c.message,!0)}}var _=at(),k=u(_),j=p(u(k),2),M=p(k,2);{var I=o=>{var c=$e(),f=u(c);N(()=>C(f,a(l))),m(o,c)};A(M,o=>{a(l)&&o(I)})}var R=p(M,2),S=u(R);{var D=o=>{var c=et();m(o,c)},y=o=>{var c=tt(),f=u(c);N(()=>C(f,a(i)?"No results found":"No events yet")),m(o,c)},q=o=>{var c=oe(),f=Z(c);we(f,17,()=>a(t),b=>b.id,(b,E)=>{Qe(b,{get event(){return a(E)},onUpdate:g,onDelete:z})}),m(o,c)};A(S,o=>{a(e)&&a(t).length===0?o(D):a(t).length===0?o(y,1):o(q,!1)})}H(j,()=>a(i),o=>s(i,o)),m(v,_),O()}var nt=x('<nav class="tab-bar svelte-1n51new"><button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <span>Record</span></button> <button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <span>Search</span></button></nav>');function rt(v,n){P(n,!0);let i=Ce(n,"activeTab",3,"record");var t=nt(),e=u(t);let l;e.__click=()=>n.onTabChange("record");var d=p(e,2);let h;d.__click=()=>n.onTabChange("search"),N(()=>{l=re(e,1,"tab svelte-1n51new",null,l,{active:i()==="record"}),h=re(d,1,"tab svelte-1n51new",null,h,{active:i()==="search"})}),m(v,t),O()}K(["click"]);var it=x('<div class="loading svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div></div>'),ot=x('<main class="app svelte-1n46o8q"><!> <!></main>');function lt(v,n){P(n,!0);let i=w(null),t=w(!0),e=w("record");G(()=>{L.auth.getSession().then(({data:{session:k}})=>{s(i,k,!0),s(t,!1)});const{data:{subscription:_}}=L.auth.onAuthStateChange((k,j)=>{s(i,j,!0)});return()=>_.unsubscribe()});var l=oe(),d=Z(l);{var h=_=>{var k=it();m(_,k)},g=_=>{De(_,{})},z=_=>{var k=ot(),j=u(k);{var M=S=>{Xe(S,{})},I=S=>{st(S,{})};A(j,S=>{a(e)==="record"?S(M):S(I,!1)})}var R=p(j,2);rt(R,{get activeTab(){return a(e)},onTabChange:S=>s(e,S,!0)}),m(_,k)};A(d,_=>{a(t)?_(h):a(i)?_(z,!1):_(g,1)})}m(v,l),O()}qe(lt,{target:document.getElementById("app")});"serviceWorker"in navigator&&navigator.serviceWorker.register("/noted/sw.js");
