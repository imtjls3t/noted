import{N as ve,g as de,a as ue,L as pe,d as F,p as O,i as A,b as a,s as t,t as N,e as he,c as Y,f as m,h as J,j as w,k as d,l as p,m as x,n as M,o as P,u as X,q as fe,r as Z,v as be,w as ge,x as _e,y as ie,z as ke,A as me,B as ye,C as ne,D as we}from"./profiles-CYDD6ipJ.js";const xe=Symbol("is custom element"),Se=Symbol("is html");function oe(u,o,n,e){var s=qe(u);s[o]!==(s[o]=n)&&(o==="loading"&&(u[pe]=n),n==null?u.removeAttribute(o):typeof n!="string"&&je(u).includes(o)?u[o]=n:u.setAttribute(o,n))}function qe(u){return u.__attributes??={[xe]:u.nodeName.includes("-"),[Se]:u.namespaceURI===ve}}var re=new Map;function je(u){var o=u.getAttribute("is")||u.nodeName,n=re.get(o);if(n)return n;re.set(o,n=[]);for(var e,s=u,l=Element.prototype;l!==s;){e=ue(s);for(var c in e)e[c].set&&n.push(c);s=de(s)}return n}function Te(u,o,n,e){var s=e,l=!0,c=()=>(l&&(l=!1,s=e),s),_;_=u[o],_===void 0&&e!==void 0&&(_=c());var b;return b=()=>{var q=u[o];return q===void 0?c():(l=!0,q)},b}var ze=x('<p class="error svelte-15ijoy3"> </p>'),Ee=x('<div class="login-container svelte-15ijoy3"><div class="login-header svelte-15ijoy3"><svg class="logo svelte-15ijoy3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <h1 class="svelte-15ijoy3">Noted.</h1> <p class="subtitle svelte-15ijoy3"> </p></div> <form autocomplete="on" class="svelte-15ijoy3"><div class="field svelte-15ijoy3"><input type="email" name="email" autocomplete="username" placeholder="Email" required="" class="svelte-15ijoy3"/></div> <div class="field svelte-15ijoy3"><input type="password" name="password" placeholder="Password" required="" minlength="6" class="svelte-15ijoy3"/></div> <!> <button type="submit" class="submit-btn svelte-15ijoy3"> </button></form> <button class="toggle-btn svelte-15ijoy3"> </button></div>');function Ce(u,o){O(o,!0);let n=w(""),e=w(""),s=w(!1),l=w(!1),c=w("");async function _(g){g.preventDefault(),t(l,!0),t(c,"");const{error:z}=a(s)?await P.auth.signUp({email:a(n),password:a(e),options:{emailRedirectTo:"https://imtjls3t.github.io/noted/"}}):await P.auth.signInWithPassword({email:a(n),password:a(e)});z?t(c,z.message,!0):a(s)&&t(c,"Check your email for a confirmation link."),t(l,!1)}var b=Ee(),q=d(b),h=p(d(q),4),k=d(h),j=p(q,2),C=d(j),I=d(C),R=p(C,2),S=d(R),D=p(R,2);{var y=g=>{var z=ze(),U=d(z);N(()=>M(U,a(c))),m(g,z)};A(D,g=>{a(c)&&g(y)})}var T=p(D,2),i=d(T),v=p(j,2);v.__click=()=>{t(s,!a(s)),t(c,"")};var f=d(v);N(()=>{M(k,a(s)?"Create an account":"Sign in to continue"),I.disabled=a(l),oe(S,"autocomplete",a(s)?"new-password":"current-password"),S.disabled=a(l),T.disabled=a(l),M(i,a(l)?"...":a(s)?"Sign Up":"Sign In"),M(f,a(s)?"Already have an account? Sign in":"Don't have an account? Sign up")}),he("submit",j,_),Y(I,()=>a(n),g=>t(n,g)),Y(S,()=>a(e),g=>t(e,g)),m(u,b),J()}F(["click"]);const Me="https://mmouwjthtuydpibxfbkq.supabase.co",Ie="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1tb3V3anRodHV5ZHBpYnhmYmtxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NTYwNzcsImV4cCI6MjA4NjUzMjA3N30.e-Aed6B6ZiXmJ94GujPqMXiIDKLmaRDqkUTXli-lAkc";async function Re(u){const{data:{session:o}}=await P.auth.getSession();if(!o)throw new Error("Not authenticated");const n=new FormData;n.append("audio",u,"audio.webm");const e=await fetch(`${Me}/functions/v1/transcribe`,{method:"POST",headers:{Authorization:`Bearer ${o.access_token}`,apikey:Ie},body:n}),s=await e.text();if(!e.ok){let c;try{c=JSON.parse(s).error}catch{c=s}throw new Error(c||`HTTP ${e.status}`)}const{text:l}=JSON.parse(s);return l}const se=window.SpeechRecognition||window.webkitSpeechRecognition;function Ae(){return!!se}function De({onResult:u,onEnd:o,onError:n}){if(!se)return n?.("Speech recognition is not supported in this browser."),null;const e=new se;return e.continuous=!0,e.interimResults=!0,e.lang="en-US",e.onresult=s=>{let l="",c="";for(let _=0;_<s.results.length;_++){const b=s.results[_][0].transcript;s.results[_].isFinal?l+=b:c+=b}u?.(l+c)},e.onend=()=>{o?.()},e.onerror=s=>{s.error!=="aborted"&&n?.(s.error)},{start(){e.start()},stop(){e.stop()},abort(){e.abort()}}}var Be=x('<div class="saved-flash svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><polyline points="20 6 9 17 4 12" class="svelte-1qh7tkx"></polyline></svg> <p class="svelte-1qh7tkx">Saved!</p></div>'),Ne=x('<div class="transcribing-view svelte-1qh7tkx"><div class="spinner-large svelte-1qh7tkx"></div> <p class="mic-label svelte-1qh7tkx">Transcribing...</p></div>'),Ue=x('<div class="input-area svelte-1qh7tkx"><input type="text" class="event-input svelte-1qh7tkx" placeholder="Tap mic to dictate..." enterkeyhint="done"/> <button class="save-btn svelte-1qh7tkx"> </button></div> <button class="mic-btn svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></button> <p class="hint svelte-1qh7tkx"> </p>',1),Le=x('<p class="error svelte-1qh7tkx"> </p>'),Pe=x('<div class="modal-overlay svelte-1qh7tkx"><div class="modal svelte-1qh7tkx"><div class="modal-mic recording svelte-1qh7tkx"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1qh7tkx"><rect x="9" y="1" width="6" height="12" rx="3" class="svelte-1qh7tkx"></rect><path d="M19 10v1a7 7 0 0 1-14 0v-1" class="svelte-1qh7tkx"></path><line x1="12" y1="18" x2="12" y2="23" class="svelte-1qh7tkx"></line><line x1="8" y1="23" x2="16" y2="23" class="svelte-1qh7tkx"></line></svg></div> <p class="modal-label svelte-1qh7tkx">Recording...</p> <div class="modal-buttons svelte-1qh7tkx"><button class="modal-btn cancel svelte-1qh7tkx">Cancel</button> <button class="modal-btn stop svelte-1qh7tkx">Stop</button></div></div></div>'),Oe=x('<div class="record-view svelte-1qh7tkx"><!> <!> <div class="version-row svelte-1qh7tkx"><button class="update-btn svelte-1qh7tkx">Update</button> <span class="svelte-1qh7tkx"></span></div></div> <!>',1);function Je(u,o){O(o,!0);let n=w(""),e=w("idle"),s=w(""),l=!1,c=w(!1),_=w(!1),b=null,q=[],h=null,k=null;X(()=>{fe().then(r=>{t(c,r?.is_premium??!1,!0),t(_,!0),j()}).catch(()=>{t(_,!0),j()})});function j(){t(s,""),t(n,""),l=!1,a(c)?R():S()}function C(){a(c)?b?.stop():k?.stop()}function I(){l=!0,a(c)?(h&&h.getTracks().forEach(r=>r.stop()),b?.stop()):k?.abort(),t(e,"idle")}async function R(){try{h=await navigator.mediaDevices.getUserMedia({audio:!0}),q=[],b=new MediaRecorder(h,{mimeType:"audio/webm"}),b.ondataavailable=r=>{r.data.size>0&&q.push(r.data)},b.onstop=async()=>{if(h.getTracks().forEach(r=>r.stop()),h=null,!l){t(e,"transcribing");try{const r=new Blob(q,{type:"audio/webm"}),E=await Re(r);t(n,E,!0),t(e,"idle")}catch(r){t(s,`Transcription failed: ${r.message}`),t(e,"idle")}}},b.start(),t(e,"recording"),history.pushState({recording:!0},"")}catch(r){t(s,`Mic access denied: ${r.message}`)}}function S(){if(!Ae()){t(s,"Speech recognition not supported in this browser");return}k=De({onResult(r){t(n,r,!0)},onEnd(){k=null,a(e)==="recording"&&t(e,"idle")},onError(r){t(s,`Speech error: ${r}`),t(e,"idle")}}),k&&(k.start(),t(e,"recording"),history.pushState({recording:!0},""))}X(()=>{function r(){a(e)==="recording"&&I()}return window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)});async function D(){if("serviceWorker"in navigator){const r=await navigator.serviceWorker.getRegistration();if(r){await r.unregister();const E=await caches.keys();await Promise.all(E.map(B=>caches.delete(B)))}}location.reload()}async function y(){if(a(n).trim()){t(e,"saving"),t(s,"");try{await be(a(n).trim()),t(e,"saved"),t(n,""),setTimeout(()=>{t(e,"idle")},1200)}catch(r){t(s,`Save failed: ${r.message}`),t(e,"idle")}}}var T=Oe(),i=Z(T),v=d(i);{var f=r=>{var E=Be();m(r,E)},g=r=>{var E=Ne();m(r,E)},z=r=>{var E=Ue(),B=Z(E),W=d(B);W.__keydown=H=>H.key==="Enter"&&y();var L=p(W,2);L.__click=y;var te=d(L),ae=p(B,2);ae.__click=j;var le=p(ae,2),ce=d(le);N(H=>{L.disabled=H,M(te,a(e)==="saving"?"...":"Save"),ae.disabled=a(e)==="saving",M(ce,a(c)?"Whisper":"Web Speech API")},[()=>!a(n).trim()||a(e)==="saving"]),Y(W,()=>a(n),H=>t(n,H)),m(r,E)};A(v,r=>{a(e)==="saved"?r(f):a(e)==="transcribing"?r(g,1):r(z,!1)})}var U=p(v,2);{var G=r=>{var E=Le(),B=d(E);N(()=>M(B,a(s))),m(r,E)};A(U,r=>{a(s)&&r(G)})}var K=p(U,2),V=d(K);V.__click=D;var Q=p(V,2);Q.textContent="v9";var $=p(i,2);{var ee=r=>{var E=Pe(),B=d(E),W=p(d(B),4),L=d(W);L.__click=I;var te=p(L,2);te.__click=C,m(r,E)};A($,r=>{a(e)==="recording"&&r(ee)})}m(u,T),J()}F(["keydown","click"]);var Ve=x('<div class="delete-confirm svelte-1z0u85a"><p class="svelte-1z0u85a">Delete this record?</p> <div class="confirm-buttons svelte-1z0u85a"><button class="btn btn-danger svelte-1z0u85a">Delete</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),We=x('<div class="edit-form svelte-1z0u85a"><input type="text" class="edit-input svelte-1z0u85a"/> <div class="edit-buttons svelte-1z0u85a"><button class="btn btn-primary svelte-1z0u85a">Save</button> <button class="btn btn-secondary svelte-1z0u85a">Cancel</button></div></div>'),He=x('<div class="card-content svelte-1z0u85a"><div class="card-text svelte-1z0u85a"><span class="keywords svelte-1z0u85a"> </span> <span class="timestamp svelte-1z0u85a"> <span class="exact svelte-1z0u85a"> </span></span></div> <div class="card-actions svelte-1z0u85a"><button class="icon-btn svelte-1z0u85a" aria-label="Edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button> <button class="icon-btn delete svelte-1z0u85a" aria-label="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1z0u85a"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></div></div>'),Ye=x('<div class="card svelte-1z0u85a"><!></div>');function Xe(u,o){O(o,!0);let n=w(!1),e=w(""),s=w(!1);function l(){t(e,o.event.keywords,!0),t(n,!0)}async function c(){a(e).trim()&&(await o.onUpdate(o.event.id,a(e).trim()),t(n,!1))}function _(){t(n,!1)}function b(){t(s,!0)}async function q(){await o.onDelete(o.event.id),t(s,!1)}function h(){t(s,!1)}function k(y){const i=Date.now()-new Date(y).getTime(),v=Math.floor(i/6e4),f=Math.floor(i/36e5),g=Math.floor(i/864e5);return v<1?"just now":v<60?`${v}m ago`:f<24?`${f}h ago`:g<30?`${g}d ago`:`${Math.floor(g/30)}mo ago`}function j(y){return new Date(y).toLocaleString()}var C=Ye(),I=d(C);{var R=y=>{var T=Ve(),i=p(d(T),2),v=d(i);v.__click=q;var f=p(v,2);f.__click=h,m(y,T)},S=y=>{var T=We(),i=d(T);i.__keydown=z=>z.key==="Enter"&&c();var v=p(i,2),f=d(v);f.__click=c;var g=p(f,2);g.__click=_,Y(i,()=>a(e),z=>t(e,z)),m(y,T)},D=y=>{var T=He(),i=d(T),v=d(i),f=d(v),g=p(v,2),z=d(g),U=p(z),G=d(U),K=p(i,2),V=d(K);V.__click=l;var Q=p(V,2);Q.__click=b,N(($,ee,r)=>{M(f,o.event.keywords),oe(g,"title",$),M(z,`${ee??""} `),M(G,r)},[()=>j(o.event.timestamp),()=>k(o.event.timestamp),()=>j(o.event.timestamp)]),m(y,T)};A(I,y=>{a(s)?y(R):a(n)?y(S,1):y(D,!1)})}m(u,C),J()}F(["click","keydown"]);var Ze=x('<p class="error svelte-1kklj14"> </p>'),Fe=x('<p class="status svelte-1kklj14">Loading...</p>'),Ge=x('<p class="status svelte-1kklj14"> </p>'),Ke=x('<div class="search-view svelte-1kklj14"><div class="search-bar svelte-1kklj14"><svg class="search-icon svelte-1kklj14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" class="search-input svelte-1kklj14" placeholder="Search events..."/></div> <!> <div class="results"><!></div></div>');function Qe(u,o){O(o,!0);let n=w(""),e=w(ge([])),s=w(!1),l=w(""),c=null;X(()=>{clearTimeout(c);const i=a(n);return c=setTimeout(()=>_(i),300),()=>clearTimeout(c)});async function _(i){t(s,!0),t(l,"");try{t(e,await _e(i),!0)}catch(v){t(l,v.message,!0)}t(s,!1)}async function b(i,v){try{await ye(i,v),t(e,a(e).map(f=>f.id===i?{...f,keywords:v}:f),!0)}catch(f){t(l,f.message,!0)}}async function q(i){try{await me(i),t(e,a(e).filter(v=>v.id!==i),!0)}catch(v){t(l,v.message,!0)}}var h=Ke(),k=d(h),j=p(d(k),2),C=p(k,2);{var I=i=>{var v=Ze(),f=d(v);N(()=>M(f,a(l))),m(i,v)};A(C,i=>{a(l)&&i(I)})}var R=p(C,2),S=d(R);{var D=i=>{var v=Fe();m(i,v)},y=i=>{var v=Ge(),f=d(v);N(()=>M(f,a(n)?"No results found":"No events yet")),m(i,v)},T=i=>{var v=ie(),f=Z(v);ke(f,17,()=>a(e),g=>g.id,(g,z)=>{Xe(g,{get event(){return a(z)},onUpdate:b,onDelete:q})}),m(i,v)};A(S,i=>{a(s)&&a(e).length===0?i(D):a(e).length===0?i(y,1):i(T,!1)})}Y(j,()=>a(n),i=>t(n,i)),m(u,h),J()}var $e=x('<nav class="tab-bar svelte-1n51new"><button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> <span>Record</span></button> <button><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <span>Search</span></button> <button class="tab svelte-1n51new"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1n51new"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg> <span>Logout</span></button></nav>');function et(u,o){O(o,!0);let n=Te(o,"activeTab",3,"record");async function e(){await P.auth.signOut()}var s=$e(),l=d(s);let c;l.__click=()=>o.onTabChange("record");var _=p(l,2);let b;_.__click=()=>o.onTabChange("search");var q=p(_,2);q.__click=e,N(()=>{c=ne(l,1,"tab svelte-1n51new",null,c,{active:n()==="record"}),b=ne(_,1,"tab svelte-1n51new",null,b,{active:n()==="search"})}),m(u,s),J()}F(["click"]);var tt=x('<div class="loading svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div></div>'),at=x('<main class="app svelte-1n46o8q"><!> <!></main>');function st(u,o){O(o,!0);let n=w(null),e=w(!0),s=w("record");X(()=>{P.auth.getSession().then(({data:{session:k}})=>{t(n,k,!0),t(e,!1)});const{data:{subscription:h}}=P.auth.onAuthStateChange((k,j)=>{t(n,j,!0)});return()=>h.unsubscribe()});var l=ie(),c=Z(l);{var _=h=>{var k=tt();m(h,k)},b=h=>{Ce(h,{})},q=h=>{var k=at(),j=d(k);{var C=S=>{Je(S,{})},I=S=>{Qe(S,{})};A(j,S=>{a(s)==="record"?S(C):S(I,!1)})}var R=p(j,2);et(R,{get activeTab(){return a(s)},onTabChange:S=>t(s,S,!0)}),m(h,k)};A(c,h=>{a(e)?h(_):a(n)?h(q,!1):h(b,1)})}m(u,l),J()}we(st,{target:document.getElementById("app")});"serviceWorker"in navigator&&navigator.serviceWorker.register("/noted/sw.js");
